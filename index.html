<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prototype génération d'île</title>
    <link rel="stylesheet" href="./assets/style.css">
    <link rel="icon" href="./assets/logo.png" type="image/png">
</head>
<body>
    <section class="selection">
        <div class="information">
            <h1>Génération d'îles procédurales</h1>
            <hr>
            <p>Cette page est le centre qui permet <strong>naviguer</strong> entre toutes les versions de notre projet (terminés ou non)</p>
        </div>
        <a href="https://island-generation-git-master-loshido.vercel.app" target="_blank" id="master"> 
            <h1>Principale
                <img src="assets/externe.png" alt="lien externe">
            </h1>
            <p>Branche principale qui contient tout les travaux stables.</p>
            <span>Baptiste, Maxime, Livio et Samuel</span>
        </a>
        <a href="https://island-generation-git-couches-loshido.vercel.app" target="_blank" id="couches" class="large"> 
            <h1>Couches
                <img src="assets/externe.png" alt="lien externe">
            </h1>
            <p>Branche (version) qui supposée permettre via l'ihm dans un menu externe qui permet de gérer la hauteur des couches et leurs couleurs.</p>
            <span>Samuel (+ Livio pour rendre à temps)</span>
        </a>
        <a href="https://island-generation-git-jeu-loshido.vercel.app" target="_blank" id="jeu" class="large"> 
            <h1>Jeu
                <img src="assets/externe.png" alt="lien externe">
            </h1>
            <p>Version qui permet d'incarner un pinguin et de le diriger, on peut avoir la possibilité de changer de saison (Printemps, Été, Hiver et Automne; change les couleurs de l'île)</p>
            <span>Maxime (+ Livio refactorisation)</span>
        </a>
        <a href="https://island-generation-git-3d-loshido.vercel.app" target="_blank" id="3d" class="long"> 
            <h1>3D
                <img src="assets/externe.png" alt="lien externe">
            </h1>
            <p>Branche qui permet une visualisation de l'île en 3D (basée sur les premières versions de l'algorithme)</p>
            <span>Baptiste</span>
        </a>
        <a href="https://island-generation-git-biomes-loshido.vercel.app" target="_blank" id="biomes" class="large"> 
            <h1>Biomes
                <img src="assets/externe.png" alt="lien externe">
            </h1>
            <p>Branche, dans laquelle se trouve le prototype des zones permettant de placer les arbres, les villes et les plaines.</p>
            <span>Livio</span>
        </a>
    </section>
    <script src="./scripts/nuage.js" type="module" defer></script>
    <script type="module">
        import { new_canvas_ctx, generer_ile, dessiner_ile } from "./scripts/island.js"
        import { generer_biomes } from "./scripts/biomes.js"

        // On récupère la taille de la page
        let [w, h] = [window.innerWidth, window.innerHeight]

        // On récupère l'accès au canvas
        let ctx = new_canvas_ctx(w, h)
        ctx.imageSmoothingEnabled = false

        // Paramètres par défaut.
        const parametres = {
            seed: 404,
            resolution: 0.5,
            noise_scale: 0.0075,
            rayon_ile: 500,
            multiplicateur: 1.5,
            couleurs: true,
            octaves: 4,
            // villes: 40,
            forets: 50,
            affichage_zones: false
        }

        // On génère la matrice de valeurs de l'île
        let { ile, zones } = generer_ile(parametres, w, h)
        
        // On dessine sur le canvas l'île en fonction de la résolution
        dessiner_ile(ctx, parametres.resolution, ile, parametres.couleurs, parametres.affichage_zones)
        if(!parametres.affichage_zones) generer_biomes(parametres.resolution, {
            // villes: zones.villes,
            forets: zones.foret,
            palmiers: ile["SABLE"]
        }, w, h)
        
        const regenerate = () => {
            let { ile, zones } = generer_ile(parametres, w, h)
            dessiner_ile(ctx, parametres.resolution, ile, parametres.couleurs, parametres.affichage_zones)
            if(!parametres.affichage_zones) generer_biomes(parametres.resolution, {
                // villes: zones.villes,
                forets: zones.foret,
                palmiers: ile["SABLE"]
            }, w, h)
        }
        
        // Lorsque la fenêtre change de taille 
        window.addEventListener("resize", () => {
            [w, h] = [window.innerWidth, window.innerHeight]
            ctx = new_canvas_ctx(w, h)
            regenerate()
        })
    </script>
    <canvas id="nuage" class="slide"></canvas>
</body> 
</html>
